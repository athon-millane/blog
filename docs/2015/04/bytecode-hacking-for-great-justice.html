<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Bytecode Hacking for Great Justice</title>
    <link rel="stylesheet" type="text/css" href="/style.css" />
  </head>
  <body>
    <div class="container">
      <main id="main">
        
<div class="spacer"></div>
<a href="https://www.cloudera.com/products/fast-forward-labs-research.html">
  <img style="height: 0.8rem;" src="/images/cloudera-fast-forward-logo.png" />
</a>
<div class="spacer"></div>
<div>
  <h3 style="margin: 0"><a href="/">Blog</a></h3>
</div>
<div class="post">
  <div class="spacer"></div>
  <h5 style="margin-bottom: 4px;">
    <span>Apr 23, 2015</span> &middot;
    <span style="text-transform: capitalize;">
      
      post
      
    </span>
  </h5>
  <h1>Bytecode Hacking for Great Justice</h1>
  <!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">factorial</span>(N, result<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
    <span style="color:#66d9ef">if</span> N <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">return</span> result
    <span style="color:#66d9ef">return</span> factorial(N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, N<span style="color:#f92672">*</span>result)
</code></pre></div><p>While this is not,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">factorial</span>(N):
    <span style="color:#66d9ef">if</span> N <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> N <span style="color:#f92672">*</span> factorial(N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</code></pre></div><!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">factorial</span>(N, result<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
    <span style="color:#66d9ef">while</span> True:
        <span style="color:#66d9ef">if</span> N <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">return</span> result
        N, result <span style="color:#f92672">=</span> N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, N<span style="color:#f92672">*</span>result
</code></pre></div><!-- raw HTML omitted -->
<pre><code>&gt;&gt;&gt; dis.dis(factorial)
# bytecode                                             # relevant python
# -----------------------------------------------------#---------------------
  2           0 LOAD_FAST                0 (N)         # if N == 1:
              3 LOAD_CONST               1 (1)         #
              6 COMPARE_OP               2 (==)        #
              9 POP_JUMP_IF_FALSE       16             #
                                                       #
  3          12 LOAD_FAST               1 (result)     #    return result
             15 RETURN_VALUE                           #
                                                       #
  4     &gt;&gt;   16 LOAD_GLOBAL              0 (factorial) # return factorial(N-1, N*result)
             19 LOAD_FAST                0 (N)         #
             22 LOAD_CONST               1 (1)         #
             25 BINARY_SUBTRACT                        #
             26 LOAD_FAST                0 (N)         #
             29 LOAD_FAST                1 (result)    #
             32 BINARY_MULTIPLY                        #
             33 CALL_FUNCTION            2             #
             36 RETURN_VALUE                           #
</code></pre><!-- raw HTML omitted -->
<pre><code>  2     &gt;&gt;    0 LOAD_FAST                0 (N)
              3 LOAD_CONST               1 (1)
              6 COMPARE_OP               2 (==)
              9 POP_JUMP_IF_FALSE       16

  3          12 LOAD_FAST               1 (result)
             15 RETURN_VALUE

  4     &gt;&gt;   16 LOAD_FAST                0 (N)
             19 LOAD_CONST               1 (1)
             22 BINARY_SUBTRACT
             23 LOAD_FAST                0 (N)
             26 LOAD_FAST                1 (result)
             29 BINARY_MULTIPLY
             30 STORE_FAST               1 (result)
             33 STORE_FAST               0 (N)
             36 JUMP_ABSOLUTE            0
</code></pre><!-- raw HTML omitted -->
<p><!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

  <div class="spacer"></div>
  <hr />
</div>

      </main>
      <div style="padding-bottom: 1rem">
        <h2 style="margin-top: 0; margin-bottom: 0px;">About</h2>
        <p style="margin-bottom: 0px;">
          Cloudera Fast Forward is an applied machine learning research group.
        </p>
        <a
          href="https://www.cloudera.com/products/fast-forward-labs-research.html"
          >Cloudera</a
        >&nbsp;
        <a href="http://experiments.fastforwardlabs.com">Experiments</a>&nbsp;
        <a href="https://twitter.com/fastforwardlabs">Twitter</a>
        <p></p>
      </div>
    </div>
  </body>
</html>
